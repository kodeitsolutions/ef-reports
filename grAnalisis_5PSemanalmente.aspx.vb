'-------------------------------------------------------------------------------------------'
' Inicio del codigo
'-------------------------------------------------------------------------------------------'
' Importando librerias 
'-------------------------------------------------------------------------------------------'
Imports System.Data

'-------------------------------------------------------------------------------------------'
' Inicio de clase "grAnalisis_5PSemanalmente"
'-------------------------------------------------------------------------------------------'
Partial Class grAnalisis_5PSemanalmente
    Inherits vis2formularios.frmReporte

    Dim loObjetoReporte As CrystalDecisions.CrystalReports.Engine.ReportDocument

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

        Try

          
            Dim lcOrdenamiento As String = cusAplicacion.goReportes.pcOrden

            Dim loComandoSeleccionar As New StringBuilder()

			loComandoSeleccionar.AppendLine("    ")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    -------------    Grafico de Ganancias   --------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine(" SELECT  ")
            loComandoSeleccionar.AppendLine(" 			DatePart(Week, Facturas.Fec_Ini) As Semana, ")
            loComandoSeleccionar.AppendLine(" 			DatePart(Year, Facturas.Fec_Ini) As Año,  ")
            loComandoSeleccionar.AppendLine(" 			Facturas.Cod_Cli, ")
            loComandoSeleccionar.AppendLine(" 			Clientes.Nom_Cli, ")
            loComandoSeleccionar.AppendLine("             (SUM(Renglones_Facturas.Mon_Net) - SUM(Renglones_Facturas.Can_Art1 * Renglones_Facturas.Cos_Ult1))/COUNT(Facturas.Documento) AS Ganancia_A ")
            'loComandoSeleccionar.AppendLine("           (((SUM(Renglones_Facturas.Mon_Net) - SUM(Renglones_Facturas.Can_Art1 * Renglones_Facturas.Cos_Ult1))/CASE WHEN SUM(Renglones_Facturas.Mon_Net) = 0 THEN 1 ELSE SUM(Renglones_Facturas.Mon_Net) END)*100)  AS Ganancia_A")
            loComandoSeleccionar.AppendLine(" INTO #tempDatos1_GG  ")
            loComandoSeleccionar.AppendLine(" FROM Facturas  ")
            loComandoSeleccionar.AppendLine(" JOIN Clientes ON Clientes.Cod_Cli = Facturas.Cod_Cli  ")
            loComandoSeleccionar.AppendLine(" JOIN Vendedores ON Vendedores.Cod_Ven = Facturas.Cod_Ven  ")
            loComandoSeleccionar.AppendLine(" JOIN Renglones_Facturas ON Renglones_Facturas.Documento = Facturas.Documento  ")
            loComandoSeleccionar.AppendLine(" JOIN Articulos ON Renglones_Facturas.Cod_Art = Articulos.Cod_Art  ")
            loComandoSeleccionar.AppendLine(" LEFT JOIN Renglones_dClientes ON Renglones_dClientes.Doc_Ori = Facturas.Documento AND Articulos.Cod_Art = Renglones_dClientes.Cod_Art  ")
            loComandoSeleccionar.AppendLine(" LEFT JOIN Devoluciones_Clientes ON Devoluciones_Clientes.Documento = Renglones_dClientes.Documento  ")
            loComandoSeleccionar.AppendLine(" Where Facturas.Fec_Ini > DATEADD (WEEK , -29, GETDATE()) ")
            loComandoSeleccionar.AppendLine("		And " & cusAplicacion.goFormatos.pcCondicionPrincipal)
            loComandoSeleccionar.AppendLine(" GROUP BY  DatePart(Week, Facturas.Fec_Ini), DatePart(Year, Facturas.Fec_Ini), /*CONVERT(NCHAR(8), Facturas.Fec_Ini, 112),*/ Facturas.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine(" ORDER BY  DatePart(Week, Facturas.Fec_Ini), DatePart(Year, Facturas.Fec_Ini), /*CONVERT(NCHAR(8), Facturas.Fec_Ini, 112),*/ Facturas.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT  ")
            loComandoSeleccionar.AppendLine(" 			DatePart(Week, Facturas.Fec_Ini) As Semana, ")
            loComandoSeleccionar.AppendLine(" 			DatePart(Year, Facturas.Fec_Ini) As Año,  ")
            loComandoSeleccionar.AppendLine(" 			Facturas.Cod_Cli, ")
            loComandoSeleccionar.AppendLine(" 			Clientes.Nom_Cli, ")
            loComandoSeleccionar.AppendLine("             (SUM(Renglones_Facturas.Mon_Net) - SUM(Renglones_Facturas.Can_Art1 * Renglones_Facturas.Cos_Ult1))/COUNT(Facturas.Documento) AS Ganancia_A ")
            'loComandoSeleccionar.AppendLine("           (((SUM(Renglones_Facturas.Mon_Net) - SUM(Renglones_Facturas.Can_Art1 * Renglones_Facturas.Cos_Ult1))/CASE WHEN SUM(Renglones_Facturas.Mon_Net) = 0 THEN 1 ELSE SUM(Renglones_Facturas.Mon_Net) END)*100)  AS Ganancia_A")
            loComandoSeleccionar.AppendLine(" INTO #tempDatos2_GG  ")
            loComandoSeleccionar.AppendLine(" FROM Facturas  ")
            loComandoSeleccionar.AppendLine(" JOIN Clientes ON Clientes.Cod_Cli = Facturas.Cod_Cli  ")
            loComandoSeleccionar.AppendLine(" JOIN Vendedores ON Vendedores.Cod_Ven = Facturas.Cod_Ven  ")
            loComandoSeleccionar.AppendLine(" JOIN Renglones_Facturas ON Renglones_Facturas.Documento = Facturas.Documento  ")
            loComandoSeleccionar.AppendLine(" JOIN Articulos ON Renglones_Facturas.Cod_Art = Articulos.Cod_Art  ")
            loComandoSeleccionar.AppendLine(" LEFT JOIN Renglones_dClientes ON Renglones_dClientes.Doc_Ori = Facturas.Documento AND Articulos.Cod_Art = Renglones_dClientes.Cod_Art  ")
            loComandoSeleccionar.AppendLine(" LEFT JOIN Devoluciones_Clientes ON Devoluciones_Clientes.Documento = Renglones_dClientes.Documento  ")
            loComandoSeleccionar.AppendLine(" Where Facturas.Fec_Ini > DATEADD (WEEK , -29, GETDATE()) ")
            loComandoSeleccionar.AppendLine("		And " & cusAplicacion.goFormatos.pcCondicionPrincipal.Replace("="," <> "))
            loComandoSeleccionar.AppendLine(" GROUP BY  DatePart(Week, Facturas.Fec_Ini), DatePart(Year, Facturas.Fec_Ini), /*CONVERT(NCHAR(8), Facturas.Fec_Ini, 112),*/ Facturas.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine(" ORDER BY  DatePart(Week, Facturas.Fec_Ini), DatePart(Year, Facturas.Fec_Ini), /*CONVERT(NCHAR(8), Facturas.Fec_Ini, 112),*/ Facturas.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ey_Clientes_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ex_Clientes_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_fac_xEx_yEy_Clientes_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_fac_xEx_xEx_Clientes_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_a_Clientes_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_b_Clientes_GG real ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ey_Cliente_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ex_Cliente_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_fac_xEx_yEy_Cliente_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_fac_xEx_xEx_Cliente_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_a_Cliente_GG real ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_b_Cliente_GG real ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -29, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -29, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" INTO #tempDatosSemanasClientes_GG ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -28, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -28, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -27, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -27, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -26, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -26, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -25, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -25, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -24, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -24, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -23, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -23, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -22, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -22, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -21, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -21, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -20, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -20, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -19, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -19, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -18, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -18, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -17, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -17, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -16, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -16, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -15, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -15, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -14, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -14, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -13, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -13, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -12, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -12, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -11, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -11, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -10, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -10, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -9, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -9, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -8, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -8, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -7, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -7, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -6, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -6, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -5, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -5, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -4, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -4, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -3, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -3, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -2, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -2, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -1, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -1, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , 0, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT Semana, Año, Cod_Cli, Nom_Cli, Ganancia_A From #tempDatos2_GG ")
            loComandoSeleccionar.AppendLine(" Where Semana <= DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) ")
            'loComandoSeleccionar.AppendLine(" 		And Cod_Cli <> '00000006' ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -29, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -29, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" INTO #tempDatosSemanasUnCliente_GG ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -28, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -28, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -27, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -27, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -26, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -26, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -25, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -25, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -24, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -24, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -23, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -23, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -22, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -22, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -21, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -21, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -20, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -20, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -19, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -19, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -18, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -18, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -17, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -17, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -16, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -16, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -15, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -15, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -14, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -14, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -13, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -13, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -12, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -12, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -11, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -11, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -10, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -10, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -9, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -9, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -8, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -8, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -7, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -7, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -6, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -6, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -5, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -5, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -4, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -4, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -3, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -3, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -2, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -2, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , -1, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -1, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , 0, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Ganancia_A ")
            loComandoSeleccionar.AppendLine(" UNION ALL ")
            loComandoSeleccionar.AppendLine(" SELECT Semana, Año, Cod_Cli, Nom_Cli, Ganancia_A From #tempDatos1_GG ")
            loComandoSeleccionar.AppendLine(" Where Semana <= DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) ")
            'loComandoSeleccionar.AppendLine(" 		And Cod_Cli = '00000006' ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT  ")
            loComandoSeleccionar.AppendLine(" 		Semana, ")
            loComandoSeleccionar.AppendLine(" 		Año,  ")
            loComandoSeleccionar.AppendLine(" 		Sum(Ganancia_A) AS Ganancia_A, ")
            'loComandoSeleccionar.AppendLine(" 		AVG(Ganancia_A) AS Ganancia_A, ")
            loComandoSeleccionar.AppendLine(" 		ROW_NUMBER() OVER(ORDER BY Año, Semana ASC) AS Row ")
            loComandoSeleccionar.AppendLine(" INTO #tempDatosClientes_GG ")
            loComandoSeleccionar.AppendLine(" FROM #tempDatosSemanasClientes_GG ")
            loComandoSeleccionar.AppendLine(" GROUP BY Año, Semana  ")
            loComandoSeleccionar.AppendLine(" ORDER BY Año ASC , Semana Asc ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT  ")
            loComandoSeleccionar.AppendLine(" 		Semana, ")
            loComandoSeleccionar.AppendLine(" 		Año,  ")
            loComandoSeleccionar.AppendLine(" 		Sum(Ganancia_A) AS Ganancia_A, ")
            'loComandoSeleccionar.AppendLine(" 		AVG(Ganancia_A) AS Ganancia_A, ")
            loComandoSeleccionar.AppendLine(" 		ROW_NUMBER() OVER(ORDER BY Año, Semana ASC) AS Row ")
            loComandoSeleccionar.AppendLine(" INTO #tempDatosCliente_GG ")
            loComandoSeleccionar.AppendLine(" FROM #tempDatosSemanasUnCliente_GG  ")
            loComandoSeleccionar.AppendLine(" GROUP BY Año, Semana  ")
            loComandoSeleccionar.AppendLine(" ORDER BY Año ASC , Semana Asc ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ey_Clientes_GG = (SELECT SUM(Ganancia_A) FROM #tempDatosSemanasClientes_GG)/30 ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ex_Clientes_GG = 15.5 ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ey_Cliente_GG = (SELECT SUM(Ganancia_A) FROM #tempDatosSemanasUnCliente_GG)/30 ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ex_Cliente_GG = 15.5 ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT ")
            loComandoSeleccionar.AppendLine("  		((#tempDatosClientes_GG.Row - @sum_Ex_Clientes_GG)*(#tempDatosClientes_GG.Ganancia_A - @sum_Ey_Clientes_GG)) AS xEx_yEy, ")
            loComandoSeleccionar.AppendLine("  		((#tempDatosClientes_GG.Row - @sum_Ex_Clientes_GG)*(#tempDatosClientes_GG.Row - @sum_Ex_Clientes_GG)) AS xEx_xEx ")
            loComandoSeleccionar.AppendLine("  INTO #temp_tenFacUnClientes ")
            loComandoSeleccionar.AppendLine("  FROM #tempDatosClientes_GG ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT ")
            loComandoSeleccionar.AppendLine("  		((#tempDatosCliente_GG.Row - @sum_Ex_Cliente_GG)*(#tempDatosCliente_GG.Ganancia_A - @sum_Ey_Cliente_GG)) AS xEx_yEy, ")
            loComandoSeleccionar.AppendLine("  		((#tempDatosCliente_GG.Row - @sum_Ex_Cliente_GG)*(#tempDatosCliente_GG.Row - @sum_Ex_Cliente_GG)) AS xEx_xEx ")
            loComandoSeleccionar.AppendLine("  INTO #temp_tenfacUnCliente ")
            loComandoSeleccionar.AppendLine("  FROM #tempDatosCliente_GG ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  SET @sum_fac_xEx_yEy_Clientes_GG = (SELECT SUM(#temp_tenFacUnClientes.xEx_yEy) FROM #temp_tenFacUnClientes) ")
            loComandoSeleccionar.AppendLine("  SET @sum_fac_xEx_xEx_Clientes_GG = (SELECT SUM(#temp_tenFacUnClientes.xEx_xEx) FROM #temp_tenFacUnClientes) ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @sum_fac_xEx_yEy_Cliente_GG = (SELECT SUM(#temp_tenfacUnCliente.xEx_yEy) FROM #temp_tenfacUnCliente) ")
            loComandoSeleccionar.AppendLine("  SET @sum_fac_xEx_xEx_Cliente_GG = (SELECT SUM(#temp_tenfacUnCliente.xEx_xEx) FROM #temp_tenfacUnCliente) ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("   ")
            loComandoSeleccionar.AppendLine("  SET @valor_a_Clientes_GG = (@sum_fac_xEx_yEy_Clientes_GG / @sum_fac_xEx_xEx_Clientes_GG) ")
            loComandoSeleccionar.AppendLine("  SET @valor_b_Clientes_GG = (@sum_Ey_Clientes_GG-(@valor_a_Clientes_GG*@sum_Ex_Clientes_GG)) ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @valor_a_Cliente_GG = (@sum_fac_xEx_yEy_Cliente_GG / @sum_fac_xEx_xEx_Cliente_GG) ")
            loComandoSeleccionar.AppendLine("  SET @valor_b_Cliente_GG = (@sum_Ey_Cliente_GG-(@valor_a_Cliente_GG*@sum_Ex_Cliente_GG)) ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  SELECT ")
            loComandoSeleccionar.AppendLine("  	    #tempDatosCliente_GG.Semana, ")
            loComandoSeleccionar.AppendLine("  	    #tempDatosCliente_GG.Año, ")
            loComandoSeleccionar.AppendLine("  	    #tempDatosCliente_GG.Ganancia_A As Ganancia_Cliente, ")
            loComandoSeleccionar.AppendLine("  	    ((@valor_a_Cliente_GG*#tempDatosCliente_GG.Row)+@valor_b_Cliente_GG) AS Tendencia_Cliente, ")
            loComandoSeleccionar.AppendLine("  	    --#tempDatosClientes_GG.Semana, ")
            loComandoSeleccionar.AppendLine("  	    --#tempDatosClientes_GG.Año, ")
            loComandoSeleccionar.AppendLine("  	    #tempDatosClientes_GG.Ganancia_A  As Ganancia_Clientes, ")
            loComandoSeleccionar.AppendLine("  	    ((@valor_a_Clientes_GG*#tempDatosClientes_GG.Row)+@valor_b_Clientes_GG) AS Tendencia_Clientes,  ")
			loComandoSeleccionar.AppendLine("		(Select Cod_Cli From Clientes Where " & cusAplicacion.goFormatos.pcCondicionPrincipal & ") As Cod_Cli, ")
            loComandoSeleccionar.AppendLine("		(Select Nom_Cli From Clientes Where " & cusAplicacion.goFormatos.pcCondicionPrincipal & ") As Nom_Cli ")            
            loComandoSeleccionar.AppendLine("  INTO #temp_GrafGanancias ")
            loComandoSeleccionar.AppendLine("  FROM #tempDatosClientes_GG ")
            loComandoSeleccionar.AppendLine("  JOIN #tempDatosCliente_GG on #tempDatosCliente_GG.Semana = #tempDatosClientes_GG.Semana And #tempDatosCliente_GG.Año = #tempDatosClientes_GG.Año ")
'me.mEscribirConsulta(loComandoSeleccionar.ToString)
			loComandoSeleccionar.AppendLine("    ")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    -------------  Grafico de cantidades devuentas   -----------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   			DatePart(Week, Devoluciones_Clientes.Fec_Ini) As Semana, ")
            loComandoSeleccionar.AppendLine("   			DatePart(Year, Devoluciones_Clientes.Fec_Ini) As Año,  ")
            loComandoSeleccionar.AppendLine("   			Devoluciones_Clientes.Cod_Cli, ")
            loComandoSeleccionar.AppendLine("   			Clientes.Nom_Cli, ")
            loComandoSeleccionar.AppendLine("               Sum(Renglones_dClientes.Can_Art1) AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatos1_GD  ")
            loComandoSeleccionar.AppendLine("   FROM Devoluciones_Clientes  ")
            loComandoSeleccionar.AppendLine("   JOIN Clientes ON Clientes.Cod_Cli = Devoluciones_Clientes.Cod_Cli  ")
            loComandoSeleccionar.AppendLine("   JOIN Vendedores ON Vendedores.Cod_Ven = Devoluciones_Clientes.Cod_Ven  ")
            loComandoSeleccionar.AppendLine("   JOIN Renglones_dClientes ON Renglones_dClientes.Documento = Devoluciones_Clientes.Documento  ")
            loComandoSeleccionar.AppendLine("   JOIN Articulos ON Renglones_dClientes.Cod_Art = Articulos.Cod_Art  ")
            loComandoSeleccionar.AppendLine("   Where Devoluciones_Clientes.Fec_Ini > DATEADD (WEEK , -29, GETDATE()) ")
            'loComandoSeleccionar.AppendLine("  		And (clientes.cod_cli='Lord k')")
            loComandoSeleccionar.AppendLine("  		And " & cusAplicacion.goFormatos.pcCondicionPrincipal)
            loComandoSeleccionar.AppendLine("   GROUP BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("   ORDER BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   			DatePart(Week, Devoluciones_Clientes.Fec_Ini) As Semana, ")
            loComandoSeleccionar.AppendLine("   			DatePart(Year, Devoluciones_Clientes.Fec_Ini) As Año,  ")
            loComandoSeleccionar.AppendLine("   			Devoluciones_Clientes.Cod_Cli, ")
            loComandoSeleccionar.AppendLine("   			Clientes.Nom_Cli, ")
            loComandoSeleccionar.AppendLine("               Sum(Renglones_dClientes.Can_Art1) AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatos2_GD  ")
            loComandoSeleccionar.AppendLine("   FROM Devoluciones_Clientes  ")
            loComandoSeleccionar.AppendLine("   JOIN Clientes ON Clientes.Cod_Cli = Devoluciones_Clientes.Cod_Cli  ")
            loComandoSeleccionar.AppendLine("   JOIN Vendedores ON Vendedores.Cod_Ven = Devoluciones_Clientes.Cod_Ven  ")
            loComandoSeleccionar.AppendLine("   JOIN Renglones_dClientes ON Renglones_dClientes.Documento = Devoluciones_Clientes.Documento  ")
            loComandoSeleccionar.AppendLine("   JOIN Articulos ON Renglones_dClientes.Cod_Art = Articulos.Cod_Art  ")
            loComandoSeleccionar.AppendLine("   Where Devoluciones_Clientes.Fec_Ini > DATEADD (WEEK , -29, GETDATE()) ")
            'loComandoSeleccionar.AppendLine("  		And (clientes.cod_cli <> 'Lord k')")
            loComandoSeleccionar.AppendLine("  		And " & cusAplicacion.goFormatos.pcCondicionPrincipal.Replace("=","<>"))
            loComandoSeleccionar.AppendLine("   GROUP BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("   ORDER BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ey_Clientes real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ex_Clientes real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_yEy_Clientes real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_xEx_Clientes real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_a_Clientes real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_b_Clientes real ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ey_Cliente real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ex_Cliente real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_yEy_Cliente real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_xEx_Cliente real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_a_Cliente real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_b_Cliente real ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -29, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -29, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosSemanasClientes_GD ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -28, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -28, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -27, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -27, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -26, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -26, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
			loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -25, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -25, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -24, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -24, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -23, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -23, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -22, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -22, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -21, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -21, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -20, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -20, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -19, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -19, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -18, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -18, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -17, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -17, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -16, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -16, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -15, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -15, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -14, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -14, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -13, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -13, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -12, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -12, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -11, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -11, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -10, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -10, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -9, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -9, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -8, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -8, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -7, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -7, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -6, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -6, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -5, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -5, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -4, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -4, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -3, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -3, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -2, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -2, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -1, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -1, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , 0, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT Semana, Año, Cod_Cli, Nom_Cli, Devoluciones_A From #tempDatos2_GD ")
            loComandoSeleccionar.AppendLine("   Where Semana <= DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -29, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -29, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosSemanasUnCliente_GD ")
			loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -28, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -28, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -27, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -27, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -26, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -26, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -25, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -25, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -24, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -24, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -23, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -23, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -22, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -22, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -21, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -21, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -20, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -20, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -19, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -19, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -18, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -18, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -17, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -17, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -16, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -16, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -15, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -15, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -14, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -14, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -13, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -13, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -12, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -12, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -11, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -11, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -10, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -10, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -9, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -9, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -8, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -8, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -7, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -7, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -6, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -6, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -5, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -5, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -4, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -4, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -3, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -3, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -2, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -2, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -1, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -1, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , 0, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
			loComandoSeleccionar.AppendLine("   SELECT Semana, Año, Cod_Cli, Nom_Cli, Devoluciones_A From #tempDatos1_GD ")
            loComandoSeleccionar.AppendLine("   Where Semana <= DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   		Semana, ")
            loComandoSeleccionar.AppendLine("   		Año,  ")
            loComandoSeleccionar.AppendLine("   		SUM(Devoluciones_A) AS Devoluciones_A, ")
            loComandoSeleccionar.AppendLine("   		ROW_NUMBER() OVER(ORDER BY Año, Semana ASC) AS Row ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosClientes_GD ")
            loComandoSeleccionar.AppendLine("   FROM #tempDatosSemanasClientes_GD ")
            loComandoSeleccionar.AppendLine("   GROUP BY Año, Semana  ")
            loComandoSeleccionar.AppendLine("   ORDER BY Año ASC , Semana Asc ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   		Semana, ")
            loComandoSeleccionar.AppendLine("   		Año,  ")
            loComandoSeleccionar.AppendLine("   		SUM(Devoluciones_A) AS Devoluciones_A, ")
            loComandoSeleccionar.AppendLine("   		ROW_NUMBER() OVER(ORDER BY Año, Semana ASC) AS Row ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosCliente_GD ")
            loComandoSeleccionar.AppendLine("   FROM #tempDatosSemanasUnCliente_GD  ")
            loComandoSeleccionar.AppendLine("   GROUP BY Año, Semana  ")
            loComandoSeleccionar.AppendLine("   ORDER BY Año ASC , Semana Asc ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ey_Clientes = (SELECT SUM(Devoluciones_A) FROM #tempDatosSemanasClientes_GD)/30 ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ex_Clientes = 15.5 ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ey_Cliente = (SELECT SUM(Devoluciones_A) FROM #tempDatosSemanasUnCliente_GD)/30 ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ex_Cliente = 15.5 ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosClientes_GD.Row - @sum_Ex_Clientes)*(#tempDatosClientes_GD.Devoluciones_A - @sum_Ey_Clientes)) AS xEx_yEy, ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosClientes_GD.Row - @sum_Ex_Clientes)*(#tempDatosClientes_GD.Row - @sum_Ex_Clientes)) AS xEx_xEx ")
            loComandoSeleccionar.AppendLine("    INTO #temp_tenDevUnClientes ")
            loComandoSeleccionar.AppendLine("    FROM #tempDatosClientes_GD ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosCliente_GD.Row - @sum_Ex_Cliente)*(#tempDatosCliente_GD.Devoluciones_A - @sum_Ey_Cliente)) AS xEx_yEy, ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosCliente_GD.Row - @sum_Ex_Cliente)*(#tempDatosCliente_GD.Row - @sum_Ex_Cliente)) AS xEx_xEx ")
            loComandoSeleccionar.AppendLine("    INTO #temp_tenDevUnCliente ")
            loComandoSeleccionar.AppendLine("    FROM #tempDatosCliente_GD ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    SET @sum_Dev_xEx_yEy_Clientes = (SELECT SUM(#temp_tenDevUnClientes.xEx_yEy) FROM #temp_tenDevUnClientes) ")
            loComandoSeleccionar.AppendLine("    SET @sum_Dev_xEx_xEx_Clientes = (SELECT SUM(#temp_tenDevUnClientes.xEx_xEx) FROM #temp_tenDevUnClientes) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @sum_Dev_xEx_yEy_Cliente = (SELECT SUM(#temp_tenDevUnCliente.xEx_yEy) FROM #temp_tenDevUnCliente) ")
            loComandoSeleccionar.AppendLine("    SET @sum_Dev_xEx_xEx_Cliente = (SELECT SUM(#temp_tenDevUnCliente.xEx_xEx) FROM #temp_tenDevUnCliente) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("     ")
            loComandoSeleccionar.AppendLine("    SET @valor_a_Clientes = (@sum_Dev_xEx_yEy_Clientes / @sum_Dev_xEx_xEx_Clientes) ")
            loComandoSeleccionar.AppendLine("    SET @valor_b_Clientes = (@sum_Ey_Clientes-(@valor_a_Clientes*@sum_Ex_Clientes)) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @valor_a_Cliente = (@sum_Dev_xEx_yEy_Cliente / @sum_Dev_xEx_xEx_Cliente) ")
            loComandoSeleccionar.AppendLine("    SET @valor_b_Cliente = (@sum_Ey_Cliente-(@valor_a_Cliente*@sum_Ex_Cliente)) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    SELECT ")
            loComandoSeleccionar.AppendLine("    	    #tempDatosCliente_GD.Semana, ")
			loComandoSeleccionar.AppendLine("    	    #tempDatosCliente_GD.Año, ")
            loComandoSeleccionar.AppendLine("    	    #tempDatosCliente_GD.Devoluciones_A As Devoluciones_Cliente, ")
            loComandoSeleccionar.AppendLine("    	    ((@valor_a_Cliente*#tempDatosCliente_GD.Row)+@valor_b_Cliente) AS Tendencia_Cliente, ")
            loComandoSeleccionar.AppendLine("    	    --#tempDatosClientes_GD.Semana, ")
            loComandoSeleccionar.AppendLine("    	    --#tempDatosClientes_GD.Año, ")
            loComandoSeleccionar.AppendLine("    	    #tempDatosClientes_GD.Devoluciones_A  As Devoluciones_Clientes, ")
            loComandoSeleccionar.AppendLine("    	    ((@valor_a_Clientes*#tempDatosClientes_GD.Row)+@valor_b_Clientes) AS Tendencia_Clientes,  ")
            loComandoSeleccionar.AppendLine("  		(Select Cod_Cli From Clientes Where (clientes.cod_cli='Lord k')) As Cod_Cli, ")
            loComandoSeleccionar.AppendLine("  		(Select Nom_Cli From Clientes Where (clientes.cod_cli='Lord k')) As Nom_Cli ")
            loComandoSeleccionar.AppendLine("  INTO #temp_GrafDevoluciones ")
            loComandoSeleccionar.AppendLine("    FROM #tempDatosClientes_GD ")
            loComandoSeleccionar.AppendLine("    JOIN #tempDatosCliente_GD on #tempDatosCliente_GD.Semana = #tempDatosClientes_GD.Semana And #tempDatosCliente_GD.Año = #tempDatosClientes_GD.Año ")
            'me.mEscribirConsulta(loComandoSeleccionar.ToString)
			loComandoSeleccionar.AppendLine("    ")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    -------------  Grafico de Montos en devoluciones -----------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   			DatePart(Week, Devoluciones_Clientes.Fec_Ini) As Semana, ")
            loComandoSeleccionar.AppendLine("   			DatePart(Year, Devoluciones_Clientes.Fec_Ini) As Año,  ")
            loComandoSeleccionar.AppendLine("   			Devoluciones_Clientes.Cod_Cli, ")
            loComandoSeleccionar.AppendLine("   			Clientes.Nom_Cli, ")
            loComandoSeleccionar.AppendLine("               (SUM(Renglones_dClientes.Mon_Net) - SUM(Renglones_dClientes.Can_Art1 * Renglones_dClientes.Cos_Ult1)) AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatos1_GDM  ")
            loComandoSeleccionar.AppendLine("   FROM Devoluciones_Clientes  ")
            loComandoSeleccionar.AppendLine("   JOIN Clientes ON Clientes.Cod_Cli = Devoluciones_Clientes.Cod_Cli  ")
            loComandoSeleccionar.AppendLine("   JOIN Vendedores ON Vendedores.Cod_Ven = Devoluciones_Clientes.Cod_Ven  ")
            loComandoSeleccionar.AppendLine("   JOIN Renglones_dClientes ON Renglones_dClientes.Documento = Devoluciones_Clientes.Documento  ")
            loComandoSeleccionar.AppendLine("   JOIN Articulos ON Renglones_dClientes.Cod_Art = Articulos.Cod_Art  ")
            loComandoSeleccionar.AppendLine("   Where Devoluciones_Clientes.Fec_Ini > DATEADD (WEEK , -29, GETDATE()) ")
            'loComandoSeleccionar.AppendLine("  		And (clientes.cod_cli='Lord k')")
            loComandoSeleccionar.AppendLine("  		And " & cusAplicacion.goFormatos.pcCondicionPrincipal)
            loComandoSeleccionar.AppendLine("   GROUP BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("   ORDER BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   			DatePart(Week, Devoluciones_Clientes.Fec_Ini) As Semana, ")
            loComandoSeleccionar.AppendLine("   			DatePart(Year, Devoluciones_Clientes.Fec_Ini) As Año,  ")
            loComandoSeleccionar.AppendLine("   			Devoluciones_Clientes.Cod_Cli, ")
            loComandoSeleccionar.AppendLine("   			Clientes.Nom_Cli, ")
            loComandoSeleccionar.AppendLine("               (SUM(Renglones_dClientes.Mon_Net) - SUM(Renglones_dClientes.Can_Art1 * Renglones_dClientes.Cos_Ult1)) AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatos2_GDM  ")
            loComandoSeleccionar.AppendLine("   FROM Devoluciones_Clientes  ")
            loComandoSeleccionar.AppendLine("   JOIN Clientes ON Clientes.Cod_Cli = Devoluciones_Clientes.Cod_Cli  ")
            loComandoSeleccionar.AppendLine("   JOIN Vendedores ON Vendedores.Cod_Ven = Devoluciones_Clientes.Cod_Ven  ")
            loComandoSeleccionar.AppendLine("   JOIN Renglones_dClientes ON Renglones_dClientes.Documento = Devoluciones_Clientes.Documento  ")
            loComandoSeleccionar.AppendLine("   JOIN Articulos ON Renglones_dClientes.Cod_Art = Articulos.Cod_Art  ")
            loComandoSeleccionar.AppendLine("   Where Devoluciones_Clientes.Fec_Ini > DATEADD (WEEK , -29, GETDATE()) ")
            'loComandoSeleccionar.AppendLine("  		And (clientes.cod_cli <> 'Lord k')")
            loComandoSeleccionar.AppendLine("  		And " & cusAplicacion.goFormatos.pcCondicionPrincipal.Replace("=","<>"))
            loComandoSeleccionar.AppendLine("   GROUP BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("   ORDER BY  DatePart(Week, Devoluciones_Clientes.Fec_Ini), DatePart(Year, Devoluciones_Clientes.Fec_Ini), /*CONVERT(NCHAR(8), Devoluciones_Clientes.Fec_Ini, 112),*/ Devoluciones_Clientes.Cod_Cli, Clientes.Nom_Cli ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ey_Cliente_GDMs real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ex_Cliente_GDMs real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_yEy_Cliente_GDMs_GDM real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_xEx_Cliente_GDMs_GDM real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_a_Cliente_GDMs real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_b_Cliente_GDMs real ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ey_Cliente_GDM real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Ex_Cliente_GDM real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_yEy_Cliente_GDM real ")
            loComandoSeleccionar.AppendLine("   DECLARE @sum_Dev_xEx_xEx_Cliente_GDM real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_a_Cliente_GDM real ")
            loComandoSeleccionar.AppendLine("   DECLARE @valor_b_Cliente_GDM real ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -29, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -29, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosSemanasClientes_GDM ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -28, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -28, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -27, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -27, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -26, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -26, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
			loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -25, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -25, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -24, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -24, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -23, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -23, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -22, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -22, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -21, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -21, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -20, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -20, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -19, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -19, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -18, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -18, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -17, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -17, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -16, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -16, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -15, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -15, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -14, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -14, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -13, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -13, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -12, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -12, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -11, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -11, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -10, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -10, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -9, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -9, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -8, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -8, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -7, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -7, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -6, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -6, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -5, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -5, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -4, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -4, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -3, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -3, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -2, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -2, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -1, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -1, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , 0, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT Semana, Año, Cod_Cli, Nom_Cli, Devoluciones_A From #tempDatos2_GDM ")
            loComandoSeleccionar.AppendLine("   Where Semana <= DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -29, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -29, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosSemanasUnCliente_GDM ")
			loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -28, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -28, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -27, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -27, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -26, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -26, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -25, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -25, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -24, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -24, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -23, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -23, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -22, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -22, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -21, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -21, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -20, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -20, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -19, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -19, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -18, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -18, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -17, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -17, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -16, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -16, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -15, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -15, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -14, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -14, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -13, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -13, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -12, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -12, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -11, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -11, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -10, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -10, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -9, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -9, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -8, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -8, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -7, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -7, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -6, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -6, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -5, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -5, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -4, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -4, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -3, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -3, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -2, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -2, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , -1, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , -1, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
            loComandoSeleccionar.AppendLine("   SELECT DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) AS Semana, DATEPART(Year , DATEADD (WEEK , 0, GETDATE())) As Año, '' As Cod_Cli, '' As Nom_Cli, 0 AS Devoluciones_A ")
            loComandoSeleccionar.AppendLine("   UNION ALL ")
			loComandoSeleccionar.AppendLine("   SELECT Semana, Año, Cod_Cli, Nom_Cli, Devoluciones_A From #tempDatos1_GDM ")
            loComandoSeleccionar.AppendLine("   Where Semana <= DATEPART(WEEK , DATEADD (WEEK , 0, GETDATE())) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   		Semana, ")
            loComandoSeleccionar.AppendLine("   		Año,  ")
            loComandoSeleccionar.AppendLine("   		SUM(Devoluciones_A) AS Devoluciones_A, ")
            loComandoSeleccionar.AppendLine("   		ROW_NUMBER() OVER(ORDER BY Año, Semana ASC) AS Row ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosClientes_GDM ")
            loComandoSeleccionar.AppendLine("   FROM #tempDatosSemanasClientes_GDM ")
            loComandoSeleccionar.AppendLine("   GROUP BY Año, Semana  ")
            loComandoSeleccionar.AppendLine("   ORDER BY Año ASC , Semana Asc ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT  ")
            loComandoSeleccionar.AppendLine("   		Semana, ")
            loComandoSeleccionar.AppendLine("   		Año,  ")
            loComandoSeleccionar.AppendLine("   		SUM(Devoluciones_A) AS Devoluciones_A, ")
            loComandoSeleccionar.AppendLine("   		ROW_NUMBER() OVER(ORDER BY Año, Semana ASC) AS Row ")
            loComandoSeleccionar.AppendLine("   INTO #tempDatosCliente_GDM ")
            loComandoSeleccionar.AppendLine("   FROM #tempDatosSemanasUnCliente_GDM  ")
            loComandoSeleccionar.AppendLine("   GROUP BY Año, Semana  ")
            loComandoSeleccionar.AppendLine("   ORDER BY Año ASC , Semana Asc ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ey_Cliente_GDMs = (SELECT SUM(Devoluciones_A) FROM #tempDatosSemanasClientes_GDM)/30 ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ex_Cliente_GDMs = 15.5 ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ey_Cliente_GDM = (SELECT SUM(Devoluciones_A) FROM #tempDatosSemanasUnCliente_GDM)/30 ")
            loComandoSeleccionar.AppendLine("   SET @sum_Ex_Cliente_GDM = 15.5 ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosClientes_GDM.Row - @sum_Ex_Cliente_GDMs)*(#tempDatosClientes_GDM.Devoluciones_A - @sum_Ey_Cliente_GDMs)) AS xEx_yEy, ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosClientes_GDM.Row - @sum_Ex_Cliente_GDMs)*(#tempDatosClientes_GDM.Row - @sum_Ex_Cliente_GDMs)) AS xEx_xEx ")
            loComandoSeleccionar.AppendLine("    INTO #temp_tenDevMUnClientes ")
            loComandoSeleccionar.AppendLine("    FROM #tempDatosClientes_GDM ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SELECT ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosCliente_GDM.Row - @sum_Ex_Cliente_GDM)*(#tempDatosCliente_GDM.Devoluciones_A - @sum_Ey_Cliente_GDM)) AS xEx_yEy, ")
            loComandoSeleccionar.AppendLine("    		((#tempDatosCliente_GDM.Row - @sum_Ex_Cliente_GDM)*(#tempDatosCliente_GDM.Row - @sum_Ex_Cliente_GDM)) AS xEx_xEx ")
            loComandoSeleccionar.AppendLine("    INTO #temp_tenDevMUnCliente ")
            loComandoSeleccionar.AppendLine("    FROM #tempDatosCliente_GDM ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    SET @sum_Dev_xEx_yEy_Cliente_GDMs_GDM = (SELECT SUM(#temp_tenDevMUnClientes.xEx_yEy) FROM #temp_tenDevMUnClientes) ")
            loComandoSeleccionar.AppendLine("    SET @sum_Dev_xEx_xEx_Cliente_GDMs_GDM = (SELECT SUM(#temp_tenDevMUnClientes.xEx_xEx) FROM #temp_tenDevMUnClientes) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @sum_Dev_xEx_yEy_Cliente_GDM = (SELECT SUM(#temp_tenDevMUnCliente.xEx_yEy) FROM #temp_tenDevMUnCliente) ")
            loComandoSeleccionar.AppendLine("    SET @sum_Dev_xEx_xEx_Cliente_GDM = (SELECT SUM(#temp_tenDevMUnCliente.xEx_xEx) FROM #temp_tenDevMUnCliente) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("     ")
            loComandoSeleccionar.AppendLine("    SET @valor_a_Cliente_GDMs = (@sum_Dev_xEx_yEy_Cliente_GDMs_GDM / @sum_Dev_xEx_xEx_Cliente_GDMs_GDM) ")
            loComandoSeleccionar.AppendLine("    SET @valor_b_Cliente_GDMs = (@sum_Ey_Cliente_GDMs-(@valor_a_Cliente_GDMs*@sum_Ex_Cliente_GDMs)) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("   SET @valor_a_Cliente_GDM = (@sum_Dev_xEx_yEy_Cliente_GDM / @sum_Dev_xEx_xEx_Cliente_GDM) ")
            loComandoSeleccionar.AppendLine("    SET @valor_b_Cliente_GDM = (@sum_Ey_Cliente_GDM-(@valor_a_Cliente_GDM*@sum_Ex_Cliente_GDM)) ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("    SELECT ")
            loComandoSeleccionar.AppendLine("    	    #tempDatosCliente_GDM.Semana, ")
			loComandoSeleccionar.AppendLine("    	    #tempDatosCliente_GDM.Año, ")
            loComandoSeleccionar.AppendLine("    	    #tempDatosCliente_GDM.Devoluciones_A As Devoluciones_Cliente, ")
            loComandoSeleccionar.AppendLine("    	    ((@valor_a_Cliente_GDM*#tempDatosCliente_GDM.Row)+@valor_b_Cliente_GDM) AS Tendencia_Cliente, ")
            loComandoSeleccionar.AppendLine("    	    --#tempDatosClientes_GDM.Semana, ")
            loComandoSeleccionar.AppendLine("    	    --#tempDatosClientes_GDM.Año, ")
            loComandoSeleccionar.AppendLine("    	    #tempDatosClientes_GDM.Devoluciones_A  As Devoluciones_Clientes, ")
            loComandoSeleccionar.AppendLine("    	    ((@valor_a_Cliente_GDMs*#tempDatosClientes_GDM.Row)+@valor_b_Cliente_GDMs) AS Tendencia_Clientes,  ")
            loComandoSeleccionar.AppendLine("  		(Select Cod_Cli From Clientes Where (clientes.cod_cli='Lord k')) As Cod_Cli, ")
            loComandoSeleccionar.AppendLine("  		(Select Nom_Cli From Clientes Where (clientes.cod_cli='Lord k')) As Nom_Cli ")
            loComandoSeleccionar.AppendLine("  INTO #temp_GrafDevolucionesMontos ")
            loComandoSeleccionar.AppendLine("    FROM #tempDatosClientes_GDM ")
            loComandoSeleccionar.AppendLine("    JOIN #tempDatosCliente_GDM on #tempDatosCliente_GDM.Semana = #tempDatosClientes_GDM.Semana And #tempDatosCliente_GDM.Año = #tempDatosClientes_GDM.Año ")
            'me.mEscribirConsulta(loComandoSeleccionar.ToString)
            loComandoSeleccionar.AppendLine("    ")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    -------------  Grafico de cantidades devuelntas   ----------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ")
			loComandoSeleccionar.AppendLine("  SELECT  ")
            loComandoSeleccionar.AppendLine("  			Renglones_Cobros.Documento,  ")
            loComandoSeleccionar.AppendLine("  			(DATEDIFF(d, ISNULL((SELECT	MAX(Fec_Ini) FROM Detalles_Cobros WHERE	Documento = Renglones_Cobros.Documento AND Tip_Ope IN ('Cheque','Transferencia', 'Deposito', 'Tarjeta', 'Ticket')),Renglones_Cobros.Fec_Ini), Cobros.Fec_Ini))/(SELECT COUNT(Renglon) FROM Renglones_Cobros WHERE Documento = Cobros.Documento ) AS Dias  ")
            loComandoSeleccionar.AppendLine("  INTO #tempDatosClientes_GEP1 ")
			loComandoSeleccionar.AppendLine("  FROM		Cobros  ")
            loComandoSeleccionar.AppendLine("  JOIN Renglones_Cobros ON Renglones_Cobros.Documento = Cobros.Documento  ")
            loComandoSeleccionar.AppendLine("  JOIN Cuentas_Cobrar ON Cuentas_Cobrar.Documento = Renglones_Cobros.Doc_Ori AND Cuentas_Cobrar.Cod_Tip = Renglones_Cobros.Cod_Tip  ")
            loComandoSeleccionar.AppendLine("  JOIN Clientes ON Clientes.Cod_Cli = Cobros.Cod_Cli  ")
            loComandoSeleccionar.AppendLine("  WHERE ")
            loComandoSeleccionar.AppendLine(" 		Cobros.Status <> 'Anulado' ")
            'loComandoSeleccionar.AppendLine(" 		AND Cobros.Cod_Cli <> 'CMS' ")
            loComandoSeleccionar.AppendLine("  		And " & cusAplicacion.goFormatos.pcCondicionPrincipal.Replace("=","<>").Replace("clientes","Cobros"))
            loComandoSeleccionar.AppendLine(" ORDER BY Cobros.Documento DESC ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT top 30 ")
            loComandoSeleccionar.AppendLine(" 		ROW_NUMBER() OVER(ORDER BY Documento Desc) AS Row, ")
            loComandoSeleccionar.AppendLine(" 		Documento, ")
            loComandoSeleccionar.AppendLine(" 		SUM(Dias) As Dias ")
            loComandoSeleccionar.AppendLine(" INTO #tempDatosClientes_GEP2 ")
            loComandoSeleccionar.AppendLine(" FROM #tempDatosClientes_GEP1 ")
            loComandoSeleccionar.AppendLine(" GROUP BY Documento ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" Select 1 As Row ")
			loComandoSeleccionar.AppendLine(" Into #Relleno ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 2 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 3 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 4 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 5 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 6 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 7 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 8 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 9 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 10 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 11 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 12 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 13 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 14 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 15 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 16 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 17 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 18 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 19 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 20 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 21 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 22 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 23 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 24 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 25 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 26 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 27 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 28 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 29 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 30 As Row ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine(" SELECT  ")
			loComandoSeleccionar.AppendLine(" 		ISNULL(#tempDatosClientes_GEP2.Row, #Relleno.Row) As Row, ")
			loComandoSeleccionar.AppendLine(" 		#tempDatosClientes_GEP2.Documento, ")
			loComandoSeleccionar.AppendLine(" 		#tempDatosClientes_GEP2.Dias ")
			loComandoSeleccionar.AppendLine(" INTO #tempDatosClientes_GEP ")
			loComandoSeleccionar.AppendLine(" FROM #tempDatosClientes_GEP2 ")
			loComandoSeleccionar.AppendLine(" FULL JOIN #Relleno On #Relleno.Row = #tempDatosClientes_GEP2.Row ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine("  ")
   '         loComandoSeleccionar.AppendLine("  SELECT  ")
   '         loComandoSeleccionar.AppendLine("  			Renglones_Cobros.Documento,  ")
   '         loComandoSeleccionar.AppendLine("  			(DATEDIFF(d, ISNULL((SELECT	MAX(Fec_Ini) FROM Detalles_Cobros WHERE	Documento = Renglones_Cobros.Documento AND Tip_Ope IN ('Cheque','Transferencia', 'Deposito', 'Tarjeta', 'Ticket')),Renglones_Cobros.Fec_Ini), Cobros.Fec_Ini))/(SELECT COUNT(Renglon) FROM Renglones_Cobros WHERE Documento = Cobros.Documento ) AS Dias  ")
   '         loComandoSeleccionar.AppendLine("  INTO #tempDatosClientes_GEP1 ")
			'loComandoSeleccionar.AppendLine("  FROM		Cobros  ")
   '         loComandoSeleccionar.AppendLine("  JOIN Renglones_Cobros ON Renglones_Cobros.Documento = Cobros.Documento  ")
   '         loComandoSeleccionar.AppendLine("  JOIN Cuentas_Cobrar ON Cuentas_Cobrar.Documento = Renglones_Cobros.Doc_Ori AND Cuentas_Cobrar.Cod_Tip = Renglones_Cobros.Cod_Tip  ")
   '         loComandoSeleccionar.AppendLine("  JOIN Clientes ON Clientes.Cod_Cli = Cobros.Cod_Cli  ")
   '         loComandoSeleccionar.AppendLine("  WHERE ")
   '         loComandoSeleccionar.AppendLine(" 		Cobros.Status <> 'Anulado' ")
   '         loComandoSeleccionar.AppendLine(" 		AND Cobros.Cod_Cli <> 'CMS' ")
   '         loComandoSeleccionar.AppendLine(" ORDER BY Cobros.Documento DESC ")
   '         loComandoSeleccionar.AppendLine("  ")
   '         loComandoSeleccionar.AppendLine(" SELECT top 30 ")
   '         loComandoSeleccionar.AppendLine(" 		ROW_NUMBER() OVER(ORDER BY Documento Desc) AS Row, ")
   '         loComandoSeleccionar.AppendLine(" 		Documento, ")
   '         loComandoSeleccionar.AppendLine(" 		SUM(Dias) As Dias ")
   '         loComandoSeleccionar.AppendLine(" INTO #tempDatosClientes_GEP ")
   '         loComandoSeleccionar.AppendLine(" FROM #tempDatosClientes_GEP1 ")
   '         loComandoSeleccionar.AppendLine(" GROUP BY Documento ")    
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  SELECT  ")
            loComandoSeleccionar.AppendLine("  			Renglones_Cobros.Documento,  ")
            loComandoSeleccionar.AppendLine("  			(DATEDIFF(d, ISNULL((SELECT	MAX(Fec_Ini) FROM Detalles_Cobros WHERE	Documento = Renglones_Cobros.Documento AND Tip_Ope IN ('Cheque','Transferencia', 'Deposito', 'Tarjeta', 'Ticket')),Renglones_Cobros.Fec_Ini), Cobros.Fec_Ini))/(SELECT COUNT(Renglon) FROM Renglones_Cobros WHERE Documento = Cobros.Documento ) AS Dias  ")
            loComandoSeleccionar.AppendLine("  INTO #tempDatosCliente_GEP1 ")
            loComandoSeleccionar.AppendLine("  FROM		Cobros  ")
            loComandoSeleccionar.AppendLine("  JOIN Renglones_Cobros ON Renglones_Cobros.Documento = Cobros.Documento  ")
            loComandoSeleccionar.AppendLine("  JOIN Cuentas_Cobrar ON Cuentas_Cobrar.Documento = Renglones_Cobros.Doc_Ori AND Cuentas_Cobrar.Cod_Tip = Renglones_Cobros.Cod_Tip  ")
            loComandoSeleccionar.AppendLine("  JOIN Clientes ON Clientes.Cod_Cli = Cobros.Cod_Cli  ")
            loComandoSeleccionar.AppendLine("  WHERE ")
            loComandoSeleccionar.AppendLine(" 		Cobros.Status <> 'Anulado' ")
            'loComandoSeleccionar.AppendLine(" 		AND Cobros.Cod_Cli = 'CMS' ")
            loComandoSeleccionar.AppendLine("  		And " & cusAplicacion.goFormatos.pcCondicionPrincipal.Replace("clientes","Cobros"))
            loComandoSeleccionar.AppendLine(" ORDER BY Cobros.Documento DESC ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT top 30 ")
            loComandoSeleccionar.AppendLine(" 		ROW_NUMBER() OVER(ORDER BY Documento Desc) AS Row, ")
            loComandoSeleccionar.AppendLine(" 		Documento, ")
            loComandoSeleccionar.AppendLine(" 		SUM(Dias) As Dias ")
            loComandoSeleccionar.AppendLine(" INTO #tempDatosCliente_GEP2 ")
            loComandoSeleccionar.AppendLine(" FROM #tempDatosCliente_GEP1 ")
            loComandoSeleccionar.AppendLine(" GROUP BY Documento ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" Select 1 As Row ")
			loComandoSeleccionar.AppendLine(" Into #Relleno2 ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 2 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 3 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 4 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 5 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 6 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 7 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 8 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 9 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 10 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 11 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 12 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 13 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 14 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 15 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 16 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 17 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 18 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 19 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 20 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 21 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 22 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 23 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 24 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 25 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 26 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 27 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 28 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 29 As Row ")
			loComandoSeleccionar.AppendLine(" UNION ALL ")
			loComandoSeleccionar.AppendLine(" Select 30 As Row ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine(" SELECT  ")
			loComandoSeleccionar.AppendLine(" 		ISNULL(#tempDatosCliente_GEP2.Row, #Relleno2.Row) As Row, ")
			loComandoSeleccionar.AppendLine(" 		#tempDatosCliente_GEP2.Documento, ")
			loComandoSeleccionar.AppendLine(" 		#tempDatosCliente_GEP2.Dias ")
			loComandoSeleccionar.AppendLine(" INTO #tempDatosCliente_GEP ")
			loComandoSeleccionar.AppendLine(" FROM #tempDatosCliente_GEP2 ")
			loComandoSeleccionar.AppendLine(" FULL JOIN #Relleno2 On #Relleno2.Row = #tempDatosCliente_GEP2.Row ")
			loComandoSeleccionar.AppendLine("  ")
			loComandoSeleccionar.AppendLine("  ")   
   '         loComandoSeleccionar.AppendLine("  ")
            'loComandoSeleccionar.AppendLine("  SELECT  ")
            'loComandoSeleccionar.AppendLine("  			Renglones_Cobros.Documento,  ")
            'loComandoSeleccionar.AppendLine("  			(DATEDIFF(d, ISNULL((SELECT	MAX(Fec_Ini) FROM Detalles_Cobros WHERE	Documento = Renglones_Cobros.Documento AND Tip_Ope IN ('Cheque','Transferencia', 'Deposito', 'Tarjeta', 'Ticket')),Renglones_Cobros.Fec_Ini), Cobros.Fec_Ini))/(SELECT COUNT(Renglon) FROM Renglones_Cobros WHERE Documento = Cobros.Documento ) AS Dias  ")
            'loComandoSeleccionar.AppendLine("  INTO #tempDatosCliente_GEP1 ")
            'loComandoSeleccionar.AppendLine("  FROM		Cobros  ")
            'loComandoSeleccionar.AppendLine("  JOIN Renglones_Cobros ON Renglones_Cobros.Documento = Cobros.Documento  ")
            'loComandoSeleccionar.AppendLine("  JOIN Cuentas_Cobrar ON Cuentas_Cobrar.Documento = Renglones_Cobros.Doc_Ori AND Cuentas_Cobrar.Cod_Tip = Renglones_Cobros.Cod_Tip  ")
            'loComandoSeleccionar.AppendLine("  JOIN Clientes ON Clientes.Cod_Cli = Cobros.Cod_Cli  ")
            'loComandoSeleccionar.AppendLine("  WHERE ")
            'loComandoSeleccionar.AppendLine(" 		Cobros.Status <> 'Anulado' ")
            'loComandoSeleccionar.AppendLine(" 		AND Cobros.Cod_Cli = 'CMS' ")
            'loComandoSeleccionar.AppendLine(" ORDER BY Cobros.Documento DESC ")
            'loComandoSeleccionar.AppendLine("  ")
            'loComandoSeleccionar.AppendLine(" SELECT top 30 ")
            'loComandoSeleccionar.AppendLine(" 		ROW_NUMBER() OVER(ORDER BY Documento Desc) AS Row, ")
            'loComandoSeleccionar.AppendLine(" 		Documento, ")
            'loComandoSeleccionar.AppendLine(" 		SUM(Dias) As Dias ")
            'loComandoSeleccionar.AppendLine(" INTO #tempDatosCliente_GEP ")
            'loComandoSeleccionar.AppendLine(" FROM #tempDatosCliente_GEP1 ")
            'loComandoSeleccionar.AppendLine(" GROUP BY Documento ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ey_Clientes_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ex_Clientes_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Cob_xEx_yEy_Clientes_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Cob_xEx_xEx_Clientes_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_a_Clientes_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_b_Clientes_GEp real  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ey_Cliente_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Ex_Cliente_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Cob_xEx_yEy_Cliente_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @sum_Cob_xEx_xEx_Cliente_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_a_Cliente_GEP real  ")
            loComandoSeleccionar.AppendLine(" DECLARE @valor_b_Cliente_GEp real  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ey_Clientes_GEP = (SELECT SUM(Dias) FROM #tempDatosClientes_GEP)/30  ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ex_Clientes_GEP = 15.5  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ey_Cliente_GEP = (SELECT SUM(Dias) FROM #tempDatosCliente_GEP)/30  ")
            loComandoSeleccionar.AppendLine(" SET @sum_Ex_Cliente_GEP = 15.5  ")
			loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT   ")
            loComandoSeleccionar.AppendLine(" 	((#tempDatosClientes_GEP.Row - @sum_Ex_Clientes_GEP)*(#tempDatosClientes_GEP.Dias - @sum_Ey_Clientes_GEP)) AS xEx_yEy,   ")
            loComandoSeleccionar.AppendLine(" 	((#tempDatosClientes_GEP.Row - @sum_Ex_Clientes_GEP)*(#tempDatosClientes_GEP.Row - @sum_Ex_Clientes_GEP)) AS xEx_xEx   ")
            loComandoSeleccionar.AppendLine(" INTO #temp_tenCobClientes   ")
            loComandoSeleccionar.AppendLine(" FROM #tempDatosClientes_GEP  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SELECT   ")
            loComandoSeleccionar.AppendLine(" 	((#tempDatosCliente_GEP.Row - @sum_Ex_Cliente_GEP)*(#tempDatosCliente_GEP.Dias - @sum_Ey_Cliente_GEP)) AS xEx_yEy,   ")
            loComandoSeleccionar.AppendLine(" 	((#tempDatosCliente_GEP.Row - @sum_Ex_Cliente_GEP)*(#tempDatosCliente_GEP.Row - @sum_Ex_Cliente_GEP)) AS xEx_xEx   ")
            loComandoSeleccionar.AppendLine(" INTO #temp_tenCobUnCliente   ")
            loComandoSeleccionar.AppendLine(" FROM #tempDatosCliente_GEP  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  SET @sum_Cob_xEx_yEy_Clientes_GEP = (SELECT SUM(#temp_tenCobClientes.xEx_yEy) FROM #temp_tenCobClientes)  ")
            loComandoSeleccionar.AppendLine("  SET @sum_Cob_xEx_xEx_Clientes_GEP = (SELECT SUM(#temp_tenCobClientes.xEx_xEx) FROM #temp_tenCobClientes)  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  SET @sum_Cob_xEx_yEy_Cliente_GEP = (SELECT SUM(#temp_tenCobUnCliente.xEx_yEy) FROM #temp_tenCobUnCliente)  ")
            loComandoSeleccionar.AppendLine("  SET @sum_Cob_xEx_xEx_Cliente_GEP = (SELECT SUM(#temp_tenCobUnCliente.xEx_xEx) FROM #temp_tenCobUnCliente)  ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @valor_a_Clientes_GEP = (@sum_Cob_xEx_yEy_Clientes_GEP / @sum_Cob_xEx_xEx_Clientes_GEP)  ")
            loComandoSeleccionar.AppendLine(" SET @valor_b_Clientes_GEP = (@sum_Ey_Clientes_GEP-(@valor_a_Clientes_GEP*@sum_Ex_Clientes_GEP)) ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine(" SET @valor_a_Cliente_GEP = (@sum_Cob_xEx_yEy_Cliente_GEP / @sum_Cob_xEx_xEx_Cliente_GEP)  ")
            loComandoSeleccionar.AppendLine(" SET @valor_b_Cliente_GEP = (@sum_Ey_Cliente_GEP-(@valor_a_Cliente_GEP*@sum_Ex_Cliente_GEP)) ")
            loComandoSeleccionar.AppendLine("   ")
            loComandoSeleccionar.AppendLine("   SELECT   ")
            loComandoSeleccionar.AppendLine("		ROW_NUMBER() OVER(ORDER BY #tempDatosClientes_GEP.Documento desc) AS Row2,")
            loComandoSeleccionar.AppendLine("   	#tempDatosClientes_GEP.Documento As Documento_Clientes_GEP, ")
            loComandoSeleccionar.AppendLine(" 		#tempDatosClientes_GEP.Dias As Dias_Clientes_GEP,")
            loComandoSeleccionar.AppendLine("   	((@valor_a_Clientes_GEP*#tempDatosClientes_GEP.Row)+@valor_b_Clientes_GEP) AS Tendencia_Clientes_GEP, ")
            loComandoSeleccionar.AppendLine(" 		#tempDatosCliente_GEP.Documento As Documento_Cliente_GEP, ")
            loComandoSeleccionar.AppendLine(" 		#tempDatosCliente_GEP.Dias As Dias_Cliente_GEP,")
            loComandoSeleccionar.AppendLine("   	((@valor_a_Cliente_GEP*#tempDatosCliente_GEP.Row)+@valor_b_Cliente_GEP) AS Tendencia_Cliente_GEP,  ")
            loComandoSeleccionar.AppendLine(" 		DATEPART(WEEK , DATEADD (WEEK , -(30 - #tempDatosClientes_GEP.Row), GETDATE())) AS Semana,")
            loComandoSeleccionar.AppendLine(" 		DATEPART(Year , DATEADD (WEEK , -(30 - #tempDatosClientes_GEP.Row), GETDATE())) As Año")
            loComandoSeleccionar.AppendLine("   INTO #temp_GrafEfectividad   ")
            loComandoSeleccionar.AppendLine("   FROM #tempDatosClientes_GEP   ")
            loComandoSeleccionar.AppendLine("   LEFT JOIN #tempDatosCliente_GEP on #tempDatosCliente_GEP.Row = #tempDatosClientes_GEP.Row-- And #tempDatosCliente_GEP.Año = #tempDatosClientes_GEP.Año   ")
            loComandoSeleccionar.AppendLine("    ")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    -------------  Grafico de Facturas por Estatus   -----------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine("  SELECT TOP  30 ")
            loComandoSeleccionar.AppendLine("  			Case WHEN Mon_Sal > 0 And Status <> 'Anulado' Then 1 ELSE 0 END As Pendientes,")
            loComandoSeleccionar.AppendLine("  			Case WHEN Status = 'Anulado' Then 1 ELSE 0 END As Anuladas,")
            loComandoSeleccionar.AppendLine("  			Case WHEN Mon_Sal = 0 And Status <> 'Anulado' Then 1 ELSE 0 END As Cobradas,")
            loComandoSeleccionar.AppendLine("  			Case WHEN Mon_Sal > 0 And Status <> 'Anulado'  Then Mon_Sal ELSE 0 END As Pendientes_Mon_Sal,")
            loComandoSeleccionar.AppendLine("  			Case WHEN Status = 'Anulado' Then Mon_Net ELSE 0 END As Anuladas_Mon_Net,")
            loComandoSeleccionar.AppendLine("  			Case WHEN Mon_Sal = 0 And Status <> 'Anulado' Then Mon_Net ELSE 0 END As Cobradas_Mon_Net")
            loComandoSeleccionar.AppendLine("  INTO #TemFacturasStatus1")
            loComandoSeleccionar.AppendLine("  FROM Facturas")
            loComandoSeleccionar.AppendLine("  Where	" & cusAplicacion.goFormatos.pcCondicionPrincipal.Replace("clientes","Facturas"))
            loComandoSeleccionar.AppendLine("  ORDER BY Documento Desc")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  Select ")
            loComandoSeleccionar.AppendLine("  			ISNULL(SUM(Pendientes),0) As Pendientes,")
            loComandoSeleccionar.AppendLine("  			ISNULL(SUM(Anuladas),0) As Anuladas,")
            loComandoSeleccionar.AppendLine("  			ISNULL(SUM(Cobradas),0) As Cobradas,")
            loComandoSeleccionar.AppendLine("  			ISNULL(SUM(Pendientes_Mon_Sal),0) As Pendientes_Mon_Sal,")
            loComandoSeleccionar.AppendLine("  			ISNULL(SUM(Anuladas_Mon_Net),0) As Anuladas_Mon_Net,")
            loComandoSeleccionar.AppendLine("  			ISNULL(SUM(Cobradas_Mon_Net),0) As Cobradas_Mon_Net")
            loComandoSeleccionar.AppendLine("  INTO #TemFacturasStatus")
            loComandoSeleccionar.AppendLine("  From #TemFacturasStatus1")
            loComandoSeleccionar.AppendLine("    ")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    -------------  Union de todas las consultas de los distintos grafico   -------------------")
			loComandoSeleccionar.AppendLine("    -------------  Para ordenarlas en una sola tabla de manera de poder   --------------------")
			loComandoSeleccionar.AppendLine("    -------------  mostrarlas atraves de graficos    -----------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ------------------------------------------------------------------------------------------")
			loComandoSeleccionar.AppendLine("    ")
            loComandoSeleccionar.AppendLine(" SELECT  ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Semana,       ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Año,          ")
            
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Devoluciones_Cliente		As Devoluciones_Cliente_GD,    ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Tendencia_Cliente		As Tendencia_Cliente_GD,  ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Devoluciones_Clientes	As Devoluciones_Clientes_GD,   ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Tendencia_Clientes		As Tendencia_Clientes_GD,  ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Devoluciones_Cliente,    ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Tendencia_Cliente,  ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Devoluciones_Clientes,   ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevoluciones.Tendencia_Clientes,  ")
            
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Devoluciones_Cliente		As Devoluciones_Cliente_GDM,    ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Tendencia_Cliente			As Tendencia_Cliente_GDM,  ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Devoluciones_Clientes		As Devoluciones_Clientes_GDM,   ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Tendencia_Clientes			As Tendencia_Clientes_GDM,  ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Devoluciones_Cliente,    ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Tendencia_Cliente,  ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Devoluciones_Clientes,   ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafDevolucionesMontos.Tendencia_Clientes,  ")
                        
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Ganancia_Cliente			As Ganancia_Cliente_GG,")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Tendencia_Cliente			As Tendencia_Cliente_GG,  ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Ganancia_Clientes			As Ganancia_Clientes_GG,")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Tendencia_Clientes			As Tendencia_Clientes_GG,  ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Ganancia_Cliente,")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Tendencia_Cliente,  ")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Ganancia_Clientes,")
            'loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Tendencia_Clientes,  ")
            
            loComandoSeleccionar.AppendLine("  			ISNULL(#temp_GrafEfectividad.Dias_Clientes_GEP,0) As Dias_Clientes_GEP, ")
            loComandoSeleccionar.AppendLine("  			ISNULL(#temp_GrafEfectividad.Tendencia_Clientes_GEP,0) As Tendencia_Clientes_GEP, ")
            loComandoSeleccionar.AppendLine("  			ISNULL(#temp_GrafEfectividad.Dias_Cliente_GEP,0) As Dias_Cliente_GEP, ")
            loComandoSeleccionar.AppendLine("  			ISNULL(#temp_GrafEfectividad.Tendencia_Cliente_GEP, 0) As Tendencia_Cliente_GEP, ")
            loComandoSeleccionar.AppendLine("  			ISNULL(#temp_GrafEfectividad.Documento_Clientes_GEP,'       -') AS Documento_Clientes_GEP,")
            loComandoSeleccionar.AppendLine("  			ISNULL(#temp_GrafEfectividad.Documento_Cliente_GEP,'       -') As Documento_Cliente_GEP, ")
            loComandoSeleccionar.AppendLine("  			CAST(#temp_GrafEfectividad.Row2 As Integer) As Row2, ")
			'loComandoSeleccionar.AppendLine("  			#temp_GrafEfectividad.Dias_Clientes_GEP  As Dias_Clientes, ")
   '         loComandoSeleccionar.AppendLine("  			#temp_GrafEfectividad.Tendencia_Clientes_GEP As Tendencia_Clientes, ")
   '         loComandoSeleccionar.AppendLine("  			#temp_GrafEfectividad.Dias_Cliente_GEP As Dias_Cliente, ")
   '         loComandoSeleccionar.AppendLine("  			#temp_GrafEfectividad.Tendencia_Cliente_GEP As Tendencia_Cliente, ")
   '         loComandoSeleccionar.AppendLine("  			#temp_GrafEfectividad.Documento_Clientes_GEP As Documento_Clientes, ")
   '         loComandoSeleccionar.AppendLine("  			#temp_GrafEfectividad.Documento_Cliente_GEP As Documento_Cliente, ")
   '         loComandoSeleccionar.AppendLine("  			CAST(#temp_GrafEfectividad.Row2 As Integer) As Row2, ")            
            
			'loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Pendientes As Pendientes_GFS,")
   '         loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Anuladas As Anuladas_GFS,")
   '         loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Cobradas As Cobradas_GFS,")
			loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Pendientes_Mon_Sal As Pendientes_Mon_Sal_GFS,")
            loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Anuladas_Mon_Net As Anumadas_Mon_Net_GFS,")
            loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Cobradas_Mon_Net As Cobradas_Mon_Net_GFS,")    
			loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Pendientes,")
            loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Anuladas,")
            loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Cobradas,")
   '         loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Pendientes_Mon_Sal,")
   '         loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Anuladas_Mon_Net,")
   '         loComandoSeleccionar.AppendLine("  			#TemFacturasStatus.Cobradas_Mon_Net,")    
                    
            
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Cod_Cli,     ")
            loComandoSeleccionar.AppendLine(" 			#temp_GrafGanancias.Nom_Cli ")
            loComandoSeleccionar.AppendLine(" FROM #temp_GrafDevoluciones ")
            loComandoSeleccionar.AppendLine(" JOIN #temp_GrafGanancias on #temp_GrafGanancias.Semana = #temp_GrafDevoluciones.Semana And #temp_GrafGanancias.Año = #temp_GrafDevoluciones.Año  ")
            loComandoSeleccionar.AppendLine(" JOIN #temp_GrafDevolucionesMontos on #temp_GrafDevolucionesMontos.Semana = #temp_GrafDevoluciones.Semana And #temp_GrafDevolucionesMontos.Año = #temp_GrafDevoluciones.Año  ")
            loComandoSeleccionar.AppendLine(" JOIN #temp_GrafEfectividad on #temp_GrafEfectividad.Semana = #temp_GrafDevoluciones.Semana And #temp_GrafEfectividad.Año = #temp_GrafDevoluciones.Año  ")
            loComandoSeleccionar.AppendLine(" JOIN #TemFacturasStatus on CAST(#temp_GrafEfectividad.Row2 As Integer) >= 1 ")
            loComandoSeleccionar.AppendLine("  ")
            loComandoSeleccionar.AppendLine("  ")
            
            'loComandoSeleccionar.AppendLine("       And " & cusAplicacion.goFormatos.pcCondicionPrincipal)
            'loComandoSeleccionar.AppendLine(" ")
            'loComandoSeleccionar.AppendLine(" GROUP BY       ")
            'loComandoSeleccionar.AppendLine(" 	DatePart(Week, Facturas.Fec_Ini), Facturas.Cod_Cli, Clientes.Nom_Cli ")
            'loComandoSeleccionar.AppendLine(" ")
            'loComandoSeleccionar.AppendLine(" ORDER BY       ")
            'loComandoSeleccionar.AppendLine(" 	DatePart(Week, Facturas.Fec_Ini), Facturas.Cod_Cli, Clientes.Nom_Cli ")
            'loComandoSeleccionar.AppendLine(" ")
            'loComandoSeleccionar.AppendLine(" SELECT * FROM #Temp ")
                       
'me.mEscribirConsulta(loComandoSeleccionar.ToString)
          


            Dim loServicios As New cusDatos.goDatos

            Dim laDatosReporte As DataSet = loServicios.mObtenerTodosSinEsquema(loComandoSeleccionar.ToString, "curReportes")

            loObjetoReporte = cusAplicacion.goFormatos.mCargarInforme("grAnalisis_5PSemanalmente", laDatosReporte)

            '-------------------------------------------------------------------------------------------------------
            ' Verificando si el select (tabla nº0) trae registros
            '-------------------------------------------------------------------------------------------------------

            If (laDatosReporte.Tables(0).Rows.Count <= 0)  Then
                Me.WbcAdministradorMensajeModal.mMostrarMensajeModal("Información", _
                                          "No se Encontraron Registros para los Parámetros Especificados. ", _
                                           vis3Controles.wbcAdministradorMensajeModal.enumTipoMensaje.KN_Informacion, _
                                           "350px", _
                                           "200px")
            End If


            Me.mTraducirReporte(loObjetoReporte)
            Me.mFormatearCamposReporte(loObjetoReporte)
            Me.crvgrAnalisis_5PSemanalmente.ReportSource = loObjetoReporte

        Catch loExcepcion As Exception

            Me.WbcAdministradorMensajeModal.mMostrarMensajeModal("Error", _
                          "No se pudo Completar el Proceso: " & loExcepcion.Message, _
                           vis3Controles.wbcAdministradorMensajeModal.enumTipoMensaje.KN_Error, _
                           "auto", _
                           "auto")

        End Try

    End Sub

    Protected Sub Page_Unload(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Unload
        Try

            loObjetoReporte.Close()

        Catch loExcepcion As Exception


        End Try
    End Sub

End Class
'-------------------------------------------------------------------------------------------'
' Fin del codigo																			'
'-------------------------------------------------------------------------------------------'
' CMS: 15/05/10: Codigo inicial																'
'				Programacion del Primer grafico (Ganancias)									'
'-------------------------------------------------------------------------------------------'
' CMS: 02/06/10: Programacion del Primer grafico (Devoluciones)								'
'-------------------------------------------------------------------------------------------'